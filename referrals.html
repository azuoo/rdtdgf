<script>
  document.addEventListener('DOMContentLoaded', function() {
    const referralCode = localStorage.getItem('referralCode');
    const userEmail = localStorage.getItem('userEmail');

    if (referralCode) {
      document.getElementById('referralLink').innerText = https://azuoo.github.io/rdtdgf/signup.html?ref=${referralCode};
    } else {
      document.getElementById('referralLink').innerText = 'لم يتم العثور على كود الإحالة.';
    }

    if (userEmail) {
      fetch('https://script.google.com/macros/s/AKfycbxPpRmsvO2Zwg0bNY6v_jpMpJXBmlk4rjNARWPgr_0hBZmPibRDuwhYsxJklb8iIcOocg/exec?email=' + encodeURIComponent(userEmail))
        .then(response => response.json())
        .then(data => {
          if (data.referrals_count !== undefined) {
            document.getElementById('referralsCount').innerText = data.referrals_count;
          } else {
            document.getElementById('referralsCount').innerText = '0';
          }
        })
        .catch(error => {
          console.error('Error:', error);
          document.getElementById('referralsCount').innerText = 'خطأ في الاتصال';
        });
    } else {
      document.getElementById('referralsCount').innerText = 'البريد الإلكتروني غير موجود.';
    }
  });
</script>
